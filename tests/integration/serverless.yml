service: integration-tester

provider:
  name: aws
  tracing:
    lambda: true
    apiGateway: true

layers:
  python27:
    package:
      artifact: ../../.layers/datadog_lambda_py2.7.zip
  python36:
    package:
      artifact: ../../.layers/datadog_lambda_py3.6.zip
  python37:
    package:
      artifact: ../../.layers/datadog_lambda_py3.7.zip
  python38:
    package:
      artifact: ../../.layers/datadog_lambda_py3.8.zip

functions:
  async-metrics-python27:
    handler: submit_metrics.handle
    runtime: python2.7
    layers:
      - { Ref: Python27LambdaLayer }
    environment:
      DD_FLUSH_TO_LOG: true

  async-metrics-python36:
    handler: submit_metrics.handle
    runtime: python3.6
    layers:
      - { Ref: Python36LambdaLayer }
    environment:
      DD_FLUSH_TO_LOG: true

  async-metrics-python37:
    handler: submit_metrics.handle
    runtime: python3.7
    layers:
      - { Ref: Python37LambdaLayer }
    environment:
      DD_FLUSH_TO_LOG: true

  async-metrics-python38:
    handler: submit_metrics.handle
    runtime: python3.8
    layers:
      - { Ref: Python38LambdaLayer }
    environment:
      DD_FLUSH_TO_LOG: true

  sync-metrics-python27:
    handler: submit_metrics.handle
    runtime: python2.7
    layers:
      - { Ref: Python27LambdaLayer }
    environment:
      DD_API_KEY: "abcdefghijk"

  sync-metrics-python36:
    handler: submit_metrics.handle
    runtime: python3.6
    layers:
      - { Ref: Python36LambdaLayer }
    environment:
      DD_API_KEY: "abcdefghijk"

  sync-metrics-python37:
    handler: submit_metrics.handle
    runtime: python3.7
    layers:
      - { Ref: Python37LambdaLayer }
    environment:
      DD_API_KEY: "abcdefghijk"

  sync-metrics-python38:
    handler: submit_metrics.handle
    runtime: python3.8
    layers:
      - { Ref: Python38LambdaLayer }
    environment:
      DD_API_KEY: "abcdefghijk"
